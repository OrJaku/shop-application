{% extends "body.html" %}
{% block title %}Products{% endblock%}
{% block h1 %}Product list{% endblock%}
{% block page %}
<body id="shop_list">
<div id="table" class="product_list">
   <table class="table table-striped">
    <thead>
       <tr class="table_title">
            <th scope="col">#</th>
            <th scope="col"><form method="POST" action="{{ url_for('shop.shop_list')}}">Name<button class="sort_button" name="sort" value="sort_name" type="submit">S</button></form></th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
            <th scope="col"><form method="POST" action="{{ url_for('shop.shop_list')}}">ID<button class="sort_button" name="sort" value="sort_id" type="submit">S</button></form></th>
        </tr>
    </thead>
    <tbody>
    {% for item in products_list %}
        <tr>
            <th scope="row"></th>
            <td>
                  <a href="{{ url_for('shop.shop_list',product=item.name)}}" >{{ item.name }}</a>
            </td>
            <td>
                    {{ item.price }}
            </td>
            <td class="row">
                    {{ item.quantity }}
            </td>
                 <td>
                     <form id = 'checkbox_id' class="post-form" method = "POST" action="{{ url_for('shop.delete_selected')}}" >
                              {{ item.id }}
                                {% if current_user.is_authenticated %}
                                    {% if current_role == role_req %}
                                        <input type="checkbox" name="remove_product" value={{item.id}}>
                                    {% endif %}
                                {% endif %}
                     </form>
                </td>
         </tr>
        {% endfor %}
       <tbody>
   </table><br><br>
</div>
    <div class="admin_panel">
        {% if current_user.is_authenticated %}
            {% if current_role == role_req %}
            <h2>Admin panel</h2>
                 <form class="add-form" method="POST" action="{{ url_for('shop.add') }}">
                     <br> <input name="product_name" placeholder="Product name"/>
                     <br> <input name="product_price" placeholder="Price"/>
                     <br> <input name="product_quantity" placeholder="Quantity"/><br>
                     <button id="add" type="submit">Add</button>
                 </form>
                 <form method="POST" action="{{ url_for('shop.import_products') }}" enctype="multipart/form-data">
                     <br> Select a file:
                     <br><input type="file" name=file accept=".csv, .json">
                     <br><button type="submit">Import file</button><br>
                 </form>
                <form class="export-form" method="POST" action="{{ url_for('shop.export_products') }}">
                     <button type="submit">Export file</button>
                     <select class="form-control" name="format" id="format">
                            <option value='csv'>csv </option>
                            <option value='json'>json </option>
                     </select><br><br>
                 </form>
                 <form class="rem-form" method="POST">
                     <button form=checkbox_id type="submit">Delete marked</button><br><br>
                 </form>

            {% endif %}
        {% endif %}
    </div>
</body>
{% endblock %}
